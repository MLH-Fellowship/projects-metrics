name: Collect Git Metrics

on:
  workflow_dispatch:
  schedule:
    - cron: '0 */4 * * *' # “At minute 0 past every 4th hour.”

jobs:
  collect_data:
    runs-on: ubuntu-latest
    environment: production

    steps:
      - name: checkout repo content
        uses: actions/checkout@v2
        
      - name: run script
        run: /bin/bash -c "/root/projects-metrics/gs_daily.sh"
        env:
          GH_ACCESS_TOKEN: ${{ secrets.GH_ACCESS_TOKEN }}
          GH_USERNAME: ${{ secrets.GH_USERNAME }}
          GL_ACCESS_TOKEN: ${{ secrets.GL_ACCESS_TOKEN }}
          PYTHONBUFFERED: "1"